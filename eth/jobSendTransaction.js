var Web3 = require("web3-js").Web3;
var EthTx = require("ethereumjs-tx");

var ownerAddress = "0xe598350d4E3c223fCa03bbA55fb9C276576fA4ae";
var bufferPrivateKey = Buffer.from(
  "10EB93083B4F2BD8CE2FBBEE18676C6DB1EBF778DDAF8CF7255237AFE8D61C60",
  "hex"
);

var web3 = new Web3(new Web3.providers.HttpProvider(
  "https://rinkeby.infura.io/kBLFY7NMU7NrFMdpvDR8"
));

var rawTx = "0xf9014912843b9aca008307a12094948d395aa9bafb8c819f9a5ec59f36b8e92e375b80b8e43732b9f7000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000002afaf114b6833b951a00610cededd3d7c7a48ae800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000002ca09e9bbd130ee065f104f246cdaea1fd7c8963e3cf309e2dad1faf170621868140a01129c8782db11674a10207dd344b816d1bf6342fc1de8a8984d28351c7392f6c";
// var ownerAddress = "0x2afaf114b6833b951a00610cededd3d7c7a48ae8";

web3.eth.getTransactionCount(ownerAddress, async function (err, nonce) {
  console.log(nonce);

  // var txParams = {"nonce":"0x0","gasPrice":"0x3b9aca00","gasLimit":"0x7a120","to":"0x948d395aA9Bafb8C819F9A5EC59f36b8E92E375B","value":0,"data":"0x","chainId":4};
  // var tx = new EthTx(txParams);
  // tx.sign(bufferPrivateKey);

  // var rawTx = '0x' + tx.serialize().toString('hex');
  // console.log(rawTx);

  // var txParams = {"nonce":"0xf","gasPrice":"0x3b9aca00","gasLimit":"0x7a120","to":"0x948d395aA9Bafb8C819F9A5EC59f36b8E92E375B","value":"0x0","data":"0x3732b9f7000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000002afaf114b6833b951a00610cededd3d7c7a48ae80000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000","chainId":4};
  // var account = web3.eth.accounts.privateKeyToAccount("0x10EB93083B4F2BD8CE2FBBEE18676C6DB1EBF778DDAF8CF7255237AFE8D61C60");
  // var signedTx = await account.signTransaction(txParams);
  // var rawTx = signedTx.rawTransaction;
  // console.log(rawTx);

  web3.eth.sendSignedTransaction(rawTx, function (err, transactionHash) {
    console.log(err);
    console.log(transactionHash);
  });
});
